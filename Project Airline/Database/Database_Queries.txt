create database princedata;
use princedata;
show databases;

create table users(id int primary key auto_increment, 
fname varchar(50), 
lname varchar(50),
uname2 varchar(50) unique, 
upwd varchar(50) unique, 
uemail varchar(50) unique, 
umobile varchar(11) unique, 
upwd2 varchar(50) unique 
);
select * from users;
insert into users (id,fname,lname,uname2,upwd,uemail,umobile,upwd2) values
 ('4','Brock','Lesner','lesner@14','BrockLesner@F5','brocklesnerf5@gmail.com','7656791235','BrockLesner@F5');
ALTER TABLE `users` AUTO_INCREMENT = 1;
describe users; 
drop table users;
DELETE FROM users WHERE uname2='';
SELECT * FROM users WHERE id = (1);

use princedata;
CREATE TABLE Flights (flight_id int AUTO_INCREMENT PRIMARY KEY,
 flight_name varchar(100) NOT NULL,
 departure_location_id int NOT NULL,
 destination_location_id int NOT NULL,
 departure_time datetime NOT NULL,
 arrival_time datetime NOT NULL,
 price decimal(10, 2) NOT NULL,
 foreign key (departure_location_id) references Locations(location_id),
 foreign key (destination_location_id) references Locations(location_id));
select * from Flights;
DELETE FROM flights WHERE flight_id='35';
drop table flights;

use princedata;
create table Locations (location_id int auto_increment PRIMARY KEY, location_name varchar(100) NOT NULL UNIQUE);
select * from Locations ORDER BY location_id;
insert into Locations (location_name) VALUES ('Surat (STV)');
select * from Locations order by location_id asc;
drop table Locations;


use princedata;
create table admin (id int auto_increment primary key , username VARCHAR(50) NOT NULL, pwd VARCHAR(50) NOT NULL);
insert into admin (username, pwd) VALUES ('Administrator', 'admin@123');
select * from admin;
drop table admin;


use princedata;
CREATE TABLE passengers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    flight_id INT NOT NULL,
    return_flight_id INT DEFAULT NULL, 
    booking_id VARCHAR(20) NOT NULL, 
    name VARCHAR(100) NOT NULL,
    age INT NOT NULL,
    gender ENUM('Male', 'Female', 'Other') NOT NULL, 
    type ENUM('Adult', 'Child', 'Infant') NOT NULL,
    total_price DECIMAL(10,2) NOT NULL,
    payment_status VARCHAR(50) DEFAULT 'Pending',
    booking_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    travel_class VARCHAR(50) NOT NULL,
    FOREIGN KEY (flight_id) REFERENCES flights(flight_id) ON DELETE CASCADE,
    FOREIGN KEY (return_flight_id) REFERENCES flights(flight_id) ON DELETE CASCADE  
);
select * from passengers;
drop table passengers;

use princedata;
CREATE TABLE bookings (
    booking_id VARCHAR(20) PRIMARY KEY, 
    user_id INT NOT NULL,
    departure_flight_id INT NOT NULL,
    return_flight_id INT DEFAULT NULL,
    total_passengers INT NOT NULL,
    booking_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (departure_flight_id) REFERENCES flights(flight_id) ON DELETE CASCADE,
    FOREIGN KEY (return_flight_id) REFERENCES flights(flight_id) ON DELETE CASCADE
);
select * from bookings;
drop table bookings;

use princedata;
CREATE TABLE payments (
	id int auto_increment primary key,
    booking_id VARCHAR(20) NOT NULL, 
    user_id INT NOT NULL,  
    departure_flight_id INT NOT NULL,  
    return_flight_id INT DEFAULT NULL,  
    total_price DECIMAL(10,2) NOT NULL,  
    payment_method ENUM('Credit Card', 'Debit Card', 'Net Banking', 'UPI', 'Wallet') NOT NULL,  
    payment_status ENUM('Pending', 'Completed', 'Failed') NOT NULL DEFAULT 'Pending',  
    upi_id VARCHAR(100) DEFAULT NULL,  
    payment_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,  
    FOREIGN KEY (departure_flight_id) REFERENCES flights(flight_id) ON DELETE CASCADE,
    FOREIGN KEY (return_flight_id) REFERENCES flights(flight_id) ON DELETE CASCADE
);
select * from payments;
drop table payments;

use princedata;
CREATE TABLE feedback (
    id INT AUTO_INCREMENT PRIMARY KEY,
    rating1 INT,
    rating2 INT,
    rating3 INT,
    rating4 INT,
    rating5 INT,
    rating6 INT,
    suggestions TEXT
);
select * from feedback;
drop table feedback;

use princedata;
CREATE TABLE deleted_accounts (id INT PRIMARY KEY AUTO_INCREMENT, 
username VARCHAR(50) UNIQUE,
reason TEXT,
deleted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
select * from deleted_accounts;
drop table deleted_accounts;